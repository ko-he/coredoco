{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///Users/bunkohei/dev/sandbox/tsuncore/next-app/src/components/ImageUpload.tsx"],"sourcesContent":["'use client';\n\nimport Image from 'next/image';\nimport { useState, ChangeEvent, FormEvent } from 'react';\n\ninterface StoreInfo {\n  store_name?: string;\n  address?: string;\n  phone?: string;\n  hours?: string;\n  raw_response?: string;\n}\n\ninterface UploadResponse {\n  filepath: string;\n  store_info: StoreInfo[];\n}\n\ninterface MapUrlResponse {\n  map_url?: string;\n  error?: string;\n}\n\nexport default function ImageUpload() {\n  const [preview, setPreview] = useState<string>('');\n  const [storeInfo, setStoreInfo] = useState<StoreInfo[]>([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const [isGeneratingMap, setIsGeneratingMap] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [mapUrl, setMapUrl] = useState<{ [key: number]: string }>({});\n  const [mapError, setMapError] = useState<{ [key: number]: string }>({});\n\n  const handleReset = () => {\n    setPreview('');\n    setStoreInfo([]);\n    setIsLoading(false);\n    setIsGeneratingMap(false);\n    setError(null);\n    setMapUrl({});\n    setMapError({});\n    // Reset file input\n    const fileInput = document.querySelector('input[type=\"file\"]') as HTMLInputElement;\n    if (fileInput) {\n      fileInput.value = '';\n    }\n  };\n\n  const handleImageChange = (e: ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (file) {\n      const reader = new FileReader();\n      reader.onload = (e) => {\n        setPreview(e.target?.result as string);\n      };\n      reader.readAsDataURL(file);\n    }\n  };\n\n  const handleSubmit = async (e: FormEvent<HTMLFormElement>) => {\n    e.preventDefault();\n    const form = e.currentTarget;\n    const fileInput = form.querySelector('input[type=\"file\"]') as HTMLInputElement;\n\n    if (!fileInput.files?.length) {\n      setError('ファイルを選択してください');\n      return;\n    }\n\n    setIsLoading(true);\n    setError(null);\n\n    const formData = new FormData();\n    formData.append('image', fileInput.files[0]);\n\n    try {\n      const response = await fetch('/api/upload', {\n        method: 'POST',\n        body: formData,\n      });\n\n      if (!response.ok) {\n        throw new Error('アップロードに失敗しました');\n      }\n\n      const data: UploadResponse = await response.json();\n      setStoreInfo(data.store_info);\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'エラーが発生しました');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleGenerateMapUrl = async (index: number) => {\n    if (storeInfo.length === 0) return;\n\n    setIsGeneratingMap(true);\n    setMapError({[index]: ''});\n    setMapUrl({[index]: ''});\n\n    try {\n      const response = await fetch('/api/generate-map-url', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({ store_info: storeInfo[index] }),\n      });\n\n      const data: MapUrlResponse = await response.json();\n\n      if (!response.ok || data.error) {\n        throw new Error(data.error || 'マップURLの生成に失敗しました');\n      }\n\n      if (data.map_url) {\n        setMapUrl({[index]: data.map_url});\n      }\n    } catch (err) {\n      setMapError({[index]: err instanceof Error ? err.message : 'エラーが発生しました'});\n    } finally {\n      setIsGeneratingMap(false);\n    }\n  };\n\n  return (\n    <div className=\"row g-4\">\n      <div className=\"col-12\">\n        <div className=\"card\">\n          <div className=\"card-body\">\n            <h2 className=\"card-title h4 mb-4\">画像をアップロード</h2>\n            <form onSubmit={handleSubmit}>\n              <div className=\"mb-3\">\n                <input\n                  type=\"file\"\n                  accept=\"image/*\"\n                  onChange={handleImageChange}\n                  className=\"form-control\"\n                />\n              </div>\n              <button\n                type=\"submit\"\n                disabled={isLoading}\n                className=\"btn btn-primary me-2\"\n              >\n                {isLoading ? '解析中...' : '解析する'}\n              </button>\n              <button\n                type=\"button\"\n                onClick={handleReset}\n                className=\"btn btn-secondary\"\n              >\n                リセット\n              </button>\n            </form>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"col-12 col-md-6\">\n        <div className=\"card\">\n          <div className=\"card-body\">\n            <h2 className=\"card-title h4 mb-4\">アップロードされた画像</h2>\n            {preview ? (\n              <Image src={preview} alt=\"プレビュー\" className=\"img-fluid\" />\n            ) : (\n              <p className=\"text-muted\">画像を選択してください</p>\n            )}\n          </div>\n        </div>\n      </div>\n\n      <div className=\"col-12 col-md-6\">\n        <div className=\"card\">\n          <div className=\"card-body\">\n            <h2 className=\"card-title h4 mb-4\">抽出結果</h2>\n            {error ? (\n              <p className=\"text-danger\">{error}</p>\n            ) : isLoading ? (\n              <p>解析中...</p>\n            ) : storeInfo ? (\n              storeInfo.map((info, index) => (\n                <div key={info.store_name}>\n                  <dl className=\"row\">\n                    {Object.entries(info).map(([key, value]) => {\n                      const label = {\n                        store_name: '店舗名',\n                        address: '住所',\n                        phone: '電話番号',\n                        hours: '営業時間',\n                        raw_response: '解析結果（生データ）',\n                      }[key] || key;\n                      return (\n                        <div key={key} className=\"col-12 mb-2\">\n                          <dt className=\"fw-medium text-muted\">{label}</dt>\n                          <dd>{value || '情報なし'}</dd>\n                        </div>\n                      );\n                    })}\n                  </dl>\n                  <div className=\"mt-3\">\n                    <button\n                      onClick={() => handleGenerateMapUrl(index)}\n                      disabled={isGeneratingMap}\n                      className=\"btn btn-success\"\n                    >\n                      {isGeneratingMap ? '生成中...' : 'Google Maps URLを生成'}\n                    </button>\n                    {mapError && (\n                      <p className=\"text-danger mt-2\">{mapError[index]}</p>\n                    )}\n                    {mapUrl[index] && (\n                      <div className=\"mt-2\">\n                        <a\n                          href={mapUrl[index]}\n                          target=\"_blank\"\n                          rel=\"noopener noreferrer\"\n                          className=\"btn btn-outline-primary\"\n                        >\n                          Google Mapsで開く\n                        </a>\n                      </div>\n                    )}\n                  </div>\n                </div>\n              ))\n            ) : (\n              <p className=\"text-muted\">画像をアップロードしてください</p>\n            )}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n} "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 406, "column": 0}, "map": {"version":3,"sources":["file:///Users/bunkohei/dev/sandbox/tsuncore/next-app/src/app/page.tsx"],"sourcesContent":["'use client';\n\nimport ImageUpload from '@/components/ImageUpload';\n\nexport default function Home() {\n  return (\n    <main>\n      <h1 className=\"display-4 mb-4 text-center text-primary fw-bold\" style={{\n        fontFamily: \"'Mochiy Pop One', sans-serif\",\n        textShadow: \"2px 2px 4px rgba(0,0,0,0.1)\",\n        transform: \"rotate(-2deg)\",\n        background: \"linear-gradient(45deg, #ff9a9e 0%, #fad0c4 99%, #fad0c4 100%)\",\n        WebkitBackgroundClip: \"text\",\n        WebkitTextFillColor: \"transparent\",\n        padding: \"10px\",\n        borderRadius: \"10px\",\n        display: \"inline-block\"\n      }}>これどこ？アプリ</h1>\n      <div className=\"card\">\n        <ImageUpload />\n      </div>\n    </main>\n  );\n} "],"names":[],"mappings":";;;;AAEA;AAFA;;;AAIe,SAAS;IACtB,qBACE,6LAAC;;0BACC,6LAAC;gBAAG,WAAU;gBAAkD,OAAO;oBACrE,YAAY;oBACZ,YAAY;oBACZ,WAAW;oBACX,YAAY;oBACZ,sBAAsB;oBACtB,qBAAqB;oBACrB,SAAS;oBACT,cAAc;oBACd,SAAS;gBACX;0BAAG;;;;;;0BACH,6LAAC;gBAAI,WAAU;0BACb,cAAA,6LAAC,oIAAA,CAAA,UAAW;;;;;;;;;;;;;;;;AAIpB;KAnBwB","debugId":null}}]
}